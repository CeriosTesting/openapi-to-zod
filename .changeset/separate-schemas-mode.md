---
"@cerios/openapi-to-zod": minor
"@cerios/openapi-to-zod-playwright": minor
---

Add separate types and schemas mode (`outputZodSchemas`) to solve TypeScript depth errors

### The Problem

When using `z.infer<typeof schema>` with very large or deeply nested OpenAPI schemas, TypeScript's type inference can hit recursion limits, causing "Type instantiation is excessively deep and possibly infinite" (TS2589) errors.

### The Solution

New `outputZodSchemas` option generates TypeScript types and Zod schemas in separate files with explicit `z.ZodType<T>` annotations instead of relying on `z.infer`:

```typescript
// Before (can cause TS2589 errors with large schemas):
export const userSchema = z.object({ ... });
export type User = z.infer<typeof userSchema>; // ðŸ’¥ Type instantiation error

// After (explicit types, no inference needed):
// types.ts - generated by @cerios/openapi-to-typescript
export type User = { ... };

// schemas.ts - generated with z.ZodType<T> annotations
import type { User } from './types';
export const userSchema: z.ZodType<User> = z.object({ ... });
```

### New Options

- **`outputZodSchemas`**: File path for Zod schemas with explicit type annotations
- **`enumFormat`**: Choose between `"union"` or `"const-object"` for enum generation (default: `"const-object"`)
- **`typeAssertionThreshold`**: Complexity threshold for switching from `: z.ZodType<T>` annotation to `as unknown as z.ZodType<T>` double assertion for extremely large schemas

### Usage

```typescript
import { defineConfig } from "@cerios/openapi-to-zod";

export default defineConfig({
	specs: [
		{
			input: "large-api.yaml",
			outputTypes: "src/generated/types.ts", // TypeScript types
			outputZodSchemas: "src/generated/schemas.ts", // Zod schemas
			enumFormat: "const-object", // Optional
			typeAssertionThreshold: 100, // Optional: use double assertion for complex schemas
		},
	],
});
```

### Requirements

- `@cerios/openapi-to-typescript` must be installed (regular dependency)
- `outputTypes` is required when `outputZodSchemas` is specified

### Benefits

- Eliminates "Type instantiation is excessively deep" errors
- Better IDE performance with pre-computed types
- Cleaner separation of concerns between types and validation
- Full type safety maintained through explicit `z.ZodType<T>` annotations
